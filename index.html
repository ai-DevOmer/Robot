<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PALESTINE AI</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom CSS Variables (retained as per your request) */
        :root {
            --bg-primary: #0F1C2E; /* Dark Blue-Gray */
            --bg-secondary: #1A2A40; /* Slightly lighter Dark Blue-Gray */
            --text-primary: #E0E6EB; /* Off-white for readability */
            --text-secondary: #8BA4B8; /* Muted blue-gray for secondary text */
            --border-color: #2F455C; /* Darker blue-gray for borders */
            --accent-color: #00BCD4; /* Cyan/Teal - techy and sleek */
            --user-message-bg: #00796B; /* Dark Teal for user messages */
            --ai-message-bg: #263238; /* Darker gray-blue for AI messages */
            --hover-color: #00ACC1; /* Slightly darker accent on hover */
        }

        /* Applying custom properties via Tailwind config */
        @tailwind base;
        @tailwind components;
        @tailwind utilities;

        /* Base styles from original, adapted or overridden by Tailwind */
        html, body {
            @apply h-full font-inter bg-bg-primary text-text-primary leading-relaxed overflow-hidden;
        }

        .font-inter { font-family: 'Inter', sans-serif; }
        .font-montserrat { font-family: 'Montserrat', sans-serif; }

        /* Custom scrollbar for chat container */
        .chat-container::-webkit-scrollbar {
            width: 8px;
        }
        .chat-container::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 10px;
        }
        .chat-container::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 10px;
            transition: background 0.3s ease;
        }
        .chat-container::-webkit-scrollbar-thumb:hover {
            background: var(--accent-color);
        }

        /* Markdown Styling - Re-defined using custom properties and Tailwind */
        .ai-message code {
            @apply bg-opacity-10 text-accent-color px-1.5 py-0.5 rounded text-sm font-mono;
            background-color: rgba(0, 188, 212, 0.1); /* Custom color if needed */
        }

        .ai-message pre {
            @apply bg-gray-900 p-4 rounded-lg overflow-x-auto my-3 border border-border-color;
        }

        .ai-message pre code {
            @apply bg-transparent text-text-primary text-base;
        }

        .ai-message h1, .ai-message h2, .ai-message h3 {
            @apply text-accent-color mt-4 mb-2;
        }

        .ai-message a {
            @apply text-accent-color no-underline hover:text-hover-color hover:underline transition-colors duration-300;
        }

        /* Specific style for mobile menu button to ensure it's visible */
        #open-sidebar, #close-sidebar, #new-chat-mobile {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        #open-sidebar:hover, #close-sidebar:hover, #new-chat-mobile:hover {
            color: var(--accent-color);
        }

        /* Original styles for message image (kept as is, but Tailwind classes added where applicable) */
        .message img {
            max-width: 100%;
            max-height: 250px; /* Slightly smaller images */
            border-radius: 12px; /* Rounded corners for images */
            margin-top: 10px; /* Space above image */
            display: block; /* Ensure image takes full width */
        }

        /* Small pulse animation for typing indicator */
        @keyframes pulse-dot {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(0.7); opacity: 0.5; }
        }
        .animate-pulse-dot {
            animation: pulse-dot 1.5s infinite ease-in-out;
        }
        .delay-0 { animation-delay: 0s; }
        .delay-75 { animation-delay: 0.25s; }
        .delay-150 { animation-delay: 0.5s; }

        /* Ensuring rounded corners on larger screens for the main container */
        @media (min-width: 768px) {
            .sidebar {
                @apply relative transform translate-x-0 rounded-l-xl;
            }
            .main-content {
                @apply w-[calc(100%-288px)] rounded-r-xl; /* Adjust width based on fixed sidebar */
            }
            .mobile-header {
                @apply hidden;
            }
            .input-container {
                @apply relative bottom-0 left-0 w-full rounded-b-xl;
            }
            .chat-container {
                @apply pb-6; /* Less padding when input is not sticky bottom */
            }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
</head>
<body class="antialiased">
    <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-60 z-40 hidden lg:hidden"></div>

    <div class="flex h-screen max-w-7xl mx-auto rounded-xl shadow-2xl overflow-hidden transform transition-all duration-300 ease-in-out scale-95 lg:scale-100">
        <aside id="sidebar" class="fixed inset-y-0 left-0 w-72 bg-bg-secondary border-r border-border-color p-6 flex flex-col z-50 transform -translate-x-full transition-transform duration-300 ease-in-out lg:relative lg:translate-x-0 lg:rounded-l-xl">
            <div class="flex items-center justify-between mb-8">
                <h2 class="font-montserrat font-semibold text-3xl text-accent-color tracking-wide">PALESTINE AI</h2>
                <button id="close-sidebar" class="lg:hidden text-text-primary hover:text-accent-color transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <button id="new-chat-btn" class="flex items-center justify-center bg-transparent border border-accent-color text-accent-color px-5 py-3 rounded-xl cursor-pointer mb-6 transition-all duration-300 hover:bg-accent-color hover:text-bg-secondary hover:shadow-lg hover:shadow-accent-color/30 transform hover:-translate-y-0.5">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                ŸÖÿ≠ÿßÿØÿ´ÿ© ÿ¨ÿØŸäÿØÿ©
            </button>
            </aside>

        <main class="main-content flex-1 flex flex-col bg-bg-primary lg:rounded-r-xl">
            <header class="mobile-header flex items-center justify-between p-5 bg-bg-secondary border-b border-border-color shadow-md lg:hidden">
                <button id="open-sidebar" class="text-text-primary hover:text-accent-color transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <h2 class="font-montserrat font-semibold text-xl text-accent-color">ASK ME ABOUT PS AND IWILL ANSWER! IM OMER ROBOT‚ù§Ô∏è‚Äçüî•</h2>
                <button id="new-chat-mobile" class="text-text-primary hover:text-accent-color transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                </button>
            </header>

            <section id="chat-container" class="chat-container flex-1 overflow-y-auto p-6 flex flex-col gap-4 pb-24 relative">
                </section>

            <div class="input-container sticky bottom-0 left-0 w-full p-4 bg-bg-secondary border-t border-border-color flex items-end gap-3 shadow-top-lg lg:rounded-br-xl">
                <div class="flex-grow relative flex items-end bg-bg-primary rounded-xl border border-border-color pr-12">
                    <textarea
                        id="message-input"
                        placeholder="ÿ£ÿ±ÿ≥ŸÑ ÿ±ÿ≥ÿßŸÑÿ©..."
                        rows="1"
                        class="w-full p-3 text-base bg-transparent text-text-primary resize-none max-h-32 overflow-y-auto outline-none rounded-xl placeholder-text-secondary"
                    ></textarea>
                    <div class="absolute right-3 bottom-3 flex items-center gap-2">
                        <input type="file" id="gallery-input" accept="image/*" class="hidden">
                        <button id="gallery-icon" class="icon text-text-secondary hover:text-accent-color transition-colors duration-200">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                <polyline points="21 15 16 10 5 21"></polyline>
                            </svg>
                        </button>
                        <button id="checkmark-icon" class="icon text-accent-color hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                        </button>
                    </div>
                </div>
                <button id="send-btn" class="flex-shrink-0 bg-accent-color text-white p-3 rounded-xl cursor-pointer flex items-center justify-center transition-all duration-200 hover:bg-hover-color transform hover:-translate-y-0.5 disabled:bg-border-color disabled:text-text-secondary disabled:cursor-not-allowed" disabled>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                </button>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        // WARNING: Do NOT use API keys client-side in production; use a backend server
        const GEMINI_API_KEY = 'AIzaSyB66dpDKO1WLd5tIHvsTuVryIPXiXbEedA'; // Your key (kept as is)
        const OPENAI_API_KEY = 'YOUR_OPENAI_API_KEY'; // Your key (kept as is)

        let pendingImage = null; // Stores the base64 of the image selected by the user

        // DOM Elements (same as original)
        const sidebar = document.getElementById('sidebar');
        const sidebarOverlay = document.getElementById('sidebar-overlay');
        const openSidebarBtn = document.getElementById('open-sidebar');
        const closeSidebarBtn = document.getElementById('close-sidebar');
        const newChatBtn = document.getElementById('new-chat-btn');
        const newChatMobileBtn = document.getElementById('new-chat-mobile');
        const chatContainer = document.getElementById('chat-container');
        const messageInput = document.getElementById('message-input');
        const sendBtn = document.getElementById('send-btn');
        const galleryIcon = document.getElementById('gallery-icon');
        const checkmarkIcon = document.getElementById('checkmark-icon');
        const galleryInput = document.getElementById('gallery-input');

        // --- Sidebar Toggles with GSAP Animation ---
        function openSidebar() {
            sidebar.classList.add('translate-x-0');
            sidebar.classList.remove('-translate-x-full');
            sidebarOverlay.classList.remove('hidden');
            gsap.to(sidebarOverlay, { opacity: 1, duration: 0.3 }); // Animate overlay fade in
        }

        function closeSidebar() {
            sidebar.classList.remove('translate-x-0');
            sidebar.classList.add('-translate-x-full');
            gsap.to(sidebarOverlay, {
                opacity: 0,
                duration: 0.3,
                onComplete: () => sidebarOverlay.classList.add('hidden') // Hide overlay after fade out
            });
        }

        openSidebarBtn.addEventListener('click', openSidebar);
        closeSidebarBtn.addEventListener('click', closeSidebar);
        sidebarOverlay.addEventListener('click', closeSidebar);

        // --- New Chat Functionality ---
        function startNewChat() {
            // Animate chat container fading out before clearing
            gsap.to(chatContainer, {
                opacity: 0,
                y: -20, // Move up slightly
                duration: 0.3,
                onComplete: () => {
                    chatContainer.innerHTML = ''; // Clear content
                    gsap.to(chatContainer, { opacity: 1, y: 0, duration: 0.3 }); // Animate fade in
                }
            });
            closeSidebar(); // Close sidebar after starting new chat
        }

        newChatBtn.addEventListener('click', startNewChat);
        newChatMobileBtn.addEventListener('click', startNewChat);

        // --- Auto-resize textarea and enable/disable send button ---
        messageInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
            sendBtn.disabled = this.value.trim() === '' && !pendingImage;
        });

        // --- Gallery Button Functionality (kept as original, enhanced with GSAP) ---
        galleryIcon.addEventListener('click', () => galleryInput.click());

        galleryInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = () => {
                    pendingImage = reader.result.split(',')[1]; // Get base64 part
                    sendBtn.disabled = false;
                    // GSAP animation for icon swap
                    gsap.to(galleryIcon, { opacity: 0, scale: 0.5, duration: 0.2, onComplete: () => galleryIcon.classList.add('hidden') });
                    checkmarkIcon.classList.remove('hidden');
                    gsap.fromTo(checkmarkIcon, { opacity: 0, scale: 0.5 }, { opacity: 1, scale: 1, duration: 0.2 });
                    messageInput.placeholder = 'ÿ±ÿ≥ÿßŸÑÿ© ŸÖÿπ ÿµŸàÿ±ÿ©...';
                };
                reader.readAsDataURL(file);
            }
        });

        // --- Checkmark to cancel image selection (kept as original, enhanced with GSAP) ---
        checkmarkIcon.addEventListener('click', () => {
            pendingImage = null;
            // GSAP animation for icon swap back
            gsap.to(checkmarkIcon, { opacity: 0, scale: 0.5, duration: 0.2, onComplete: () => checkmarkIcon.classList.add('hidden') });
            galleryIcon.classList.remove('hidden');
            gsap.fromTo(galleryIcon, { opacity: 0, scale: 0.5 }, { opacity: 1, scale: 1, duration: 0.2 });
            messageInput.placeholder = 'ÿ£ÿ±ÿ≥ŸÑ ÿ±ÿ≥ÿßŸÑÿ©...';
            galleryInput.value = ''; // Clear file input
            sendBtn.disabled = messageInput.value.trim() === '';
        });

        // --- Send Message / Generate Image Functionality (kept as original, enhanced with typing indicator) ---
        sendBtn.addEventListener('click', async () => {
            const message = messageInput.value.trim();
            const image = pendingImage;
            pendingImage = null; // Reset pending image after sending

            if (message || image) {
                let content = '';
                if (message) content += `<p>${message}</p>`;
                // Image handling kept as original, but with Tailwind classes for responsiveness
                if (image) content += `<img src="data:image/jpeg;base64,${image}" alt="Sent image" class="mt-2 max-w-full h-auto rounded-lg">`;
                addMessage(content, true); // Add user message
            }

            // Clear input and reset state
            messageInput.value = '';
            messageInput.style.height = 'auto';
            sendBtn.disabled = true;
            // Reset icon state with GSAP
            gsap.to(checkmarkIcon, { opacity: 0, scale: 0.5, duration: 0.2, onComplete: () => checkmarkIcon.classList.add('hidden') });
            galleryIcon.classList.remove('hidden');
            gsap.fromTo(galleryIcon, { opacity: 0, scale: 0.5 }, { opacity: 1, scale: 1, duration: 0.2 });
            messageInput.placeholder = 'ÿ£ÿ±ÿ≥ŸÑ ÿ±ÿ≥ÿßŸÑÿ©...';
            galleryInput.value = ''; // Clear file input

            // Handle AI response
            try {
                // Show typing indicator before API call
                const typingIndicator = addTypingIndicator();
                const aiResponse = await generateAIResponse(message, image);
                removeTypingIndicator(typingIndicator); // Remove typing indicator
                addMessage(aiResponse, false); // Add AI response
            } catch (error) {
                console.error('Error sending message to AI:', error);
                removeTypingIndicator(document.querySelector('.typing-indicator')); // Ensure indicator is removed even on error
                addMessage('ÿπÿ∞ÿ±Ÿãÿßÿå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ŸÖÿπÿßŸÑÿ¨ÿ© ÿ∑ŸÑÿ®ŸÉ. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.', false);
            }
        });

        // --- Typing Indicator ---
        function addTypingIndicator() {
            const indicatorDiv = document.createElement('div');
            indicatorDiv.classList.add('message', 'ai-message', 'typing-indicator', 'flex', 'items-center', 'space-x-1');
            indicatorDiv.innerHTML = `
                <span class="w-2.5 h-2.5 bg-text-primary rounded-full animate-pulse-dot delay-0"></span>
                <span class="w-2.5 h-2.5 bg-text-primary rounded-full animate-pulse-dot delay-75"></span>
                <span class="w-2.5 h-2.5 bg-text-primary rounded-full animate-pulse-dot delay-150"></span>
            `;
            chatContainer.appendChild(indicatorDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            gsap.fromTo(indicatorDiv, { opacity: 0, y: 20 }, { opacity: 1, y: 0, duration: 0.3 }); // Animate typing indicator in
            return indicatorDiv;
        }

        function removeTypingIndicator(indicator) {
            if (indicator) {
                gsap.to(indicator, {
                    opacity: 0,
                    y: -20,
                    duration: 0.3,
                    onComplete: () => indicator.remove() // Remove after animation
                });
            }
        }

        // --- Gemini API Call (kept as original) ---
        async function generateAIResponse(text, imageBase64) {
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`;
            let parts = [];
            if (text) parts.push({ text: text });
            if (imageBase64) parts.push({ inlineData: { mimeType: "image/jpeg", data: imageBase64 } });

            if (parts.length === 0) {
                return "ŸÖŸÜ ŸÅÿ∂ŸÑŸÉ ÿ£ÿØÿÆŸÑ ÿ±ÿ≥ÿßŸÑÿ© ÿ£Ÿà ŸÇŸÖ ÿ®ÿ™ÿ≠ŸÖŸäŸÑ ÿµŸàÿ±ÿ© ŸÑŸÑÿ®ÿØÿ°.";
            }

            const requestBody = { contents: [{ role: "user", parts: parts }] };
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(requestBody),
                });
                const data = await response.json();

                if (data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts[0]) {
                     return data.candidates[0].content.parts[0].text;
                } else if (data.promptFeedback && data.promptFeedback.blockReason) {
                    return `ÿπÿ∞ÿ±Ÿãÿßÿå ŸÑÿß ŸäŸÖŸÉŸÜŸÜŸä ÿßŸÑÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ© ŸÑŸáÿ∞ÿß ÿßŸÑÿ∑ŸÑÿ® ÿ®ÿ≥ÿ®ÿ® ÿ≥Ÿäÿßÿ≥ÿßÿ™ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ. ÿßŸÑÿ≥ÿ®ÿ®: ${data.promptFeedback.blockReason}`;
                } else {
                    console.error("Unexpected API response structure:", data);
                    return "ÿπÿ∞ÿ±Ÿãÿßÿå ŸÑŸÇÿØ ÿ™ŸÑŸÇŸäÿ™ ÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ© ÿ∫Ÿäÿ± ŸÖÿ™ŸàŸÇÿπÿ© ŸÖŸÜ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.";
                }
            } catch (error) {
                console.error('Error fetching from Gemini API:', error);
                return "ÿ≠ÿØÿ´ÿ™ ŸÖÿ¥ŸÉŸÑÿ© ŸÅŸä ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßÿ™ÿµÿßŸÑŸÉ ÿ®ÿßŸÑÿ¥ÿ®ŸÉÿ© ÿ£Ÿà ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÑÿßÿ≠ŸÇŸãÿß.";
            }
        }

        // --- OpenAI DALL-E API for image generation (kept as original) ---
        async function generateImage(prompt) {
            const apiUrl = 'https://api.openai.com/v1/images/generations';
            const requestBody = { prompt: prompt, n: 1, size: "512x512" };
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${OPENAI_API_KEY}`
                    },
                    body: JSON.stringify(requestBody),
                });
                const data = await response.json();
                if (data.data && data.data[0] && data.data[0].url) {
                    return data.data[0].url;
                } else {
                    console.error("OpenAI API image generation error:", data);
                    return null;
                }
            } catch (error) {
                console.error('Image generation error with OpenAI API:', error);
                return null;
            }
        }

        // --- Add Message to Chat with GSAP Animation and Markdown ---
        function addMessage(content, isUser) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add(
                'message',
                isUser ? 'user-message' : 'ai-message',
                'p-4', 'rounded-2xl', 'shadow-md', 'max-w-[80%]', 'break-words', 'relative',
                isUser ? 'bg-user-message-bg text-gray-50 self-end rounded-br-md' : 'bg-ai-message-bg text-text-primary self-start rounded-bl-md'
            );

            // If it's a user message with an image, add it directly. Otherwise, parse markdown.
            // This preserves the original image handling logic.
            if (isUser && content.includes('<img src=')) {
                messageDiv.innerHTML = content;
            } else {
                // Using marked.js to parse markdown
                messageDiv.innerHTML = marked.parse(content);
            }

            // Initial state for GSAP animation
            messageDiv.style.opacity = 0;
            messageDiv.style.transform = 'translateY(20px) scale(0.95)';

            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;

            // GSAP animation for message entry
            gsap.to(messageDiv, {
                opacity: 1,
                y: 0,
                scale: 1,
                duration: 0.4,
                ease: 'back.out(1.2)', // A nice bouncy ease for interactive feel
                onComplete: () => {
                    // Ensure scroll is at bottom after animation completes
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                }
            });
        }

        // Tailwind CSS Configuration - Customizing colors and fonts
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'bg-primary': 'var(--bg-primary)',
                        'bg-secondary': 'var(--bg-secondary)',
                        'text-primary': 'var(--text-primary)',
                        'text-secondary': 'var(--text-secondary)',
                        'border-color': 'var(--border-color)',
                        'accent-color': 'var(--accent-color)',
                        'user-message-bg': 'var(--user-message-bg)',
                        'ai-message-bg': 'var(--ai-message-bg)',
                        'hover-color': 'var(--hover-color)',
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                        montserrat: ['Montserrat', 'sans-serif'],
                    },
                    boxShadow: {
                        'top-lg': '0 -8px 30px rgba(0, 0, 0, 0.3)',
                    },
                    animation: {
                        'pulse-dot': 'pulse-dot 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>
</body>
</html>
